***************
*** 105,111 ****
  		}
  	}
  
- 	private Connection currentConn;
  
  	private List hostList;
  
--- 109,115 ----
  		}
  	}
  
+ 	private ConnectionImpl currentConn;
  
  	private List hostList;
  
***************
*** 419,446 ****
  	 * @throws SQLException
  	 */
  	private synchronized void pickNewConnection() throws SQLException {
- 		if (this.currentConn == null) {
- 			this.currentConn = this.balancer.pickConnection(this,
- 					Collections.unmodifiableList(this.hostList),
- 					Collections.unmodifiableMap(this.liveConnections),
- 					(long[]) this.responseTimes.clone(),
- 					this.retriesAllDown);
- 
- 			return;
- 		}
- 		
- 		Connection newConn = this.balancer.pickConnection(this,
- 				Collections.unmodifiableList(this.hostList),
- 				Collections.unmodifiableMap(this.liveConnections),
- 				(long[]) this.responseTimes.clone(),
- 				this.retriesAllDown);
- 
- 		newConn.setTransactionIsolation(this.currentConn
- 				.getTransactionIsolation());
- 		newConn.setAutoCommit(this.currentConn.getAutoCommit());
- 
- 		this.currentConn = newConn;
- 		
  	}
  
  	/**
--- 428,453 ----
  	 * @throws SQLException
  	 */
  	private synchronized void pickNewConnection() throws SQLException {
+ 
+       ConnectionImpl newConn = (ConnectionImpl) this.balancer.pickConnection(this,
+             Collections.unmodifiableList(this.hostList),
+             Collections.unmodifiableMap(this.liveConnections),
+             (long[]) this.responseTimes.clone(),
+             this.retriesAllDown);
+ 
+       MySQLConnection thisAsConnection = (MySQLConnection) Proxy.newProxyInstance(
+               getClass().getClassLoader(),
+               new Class[] { com.mysql.jdbc.MySQLConnection.class },
+               this);
+ 
+       newConn.setProxy(thisAsConnection);
+       if (this.currentConn != null) {
+          newConn.setTransactionIsolation(this.currentConn
+                .getTransactionIsolation());
+          newConn.setAutoCommit(this.currentConn.getAutoCommit());
+       }
+       this.currentConn = newConn;
+       System.out.println("have replaced the connection");		
  	}
  
  	/**
